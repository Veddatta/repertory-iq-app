const _0x31ff31=_0x91c9;(function(_0x536998,_0x2f5221){const _0x525a07=_0x91c9,_0x1367e8=_0x536998();while(!![]){try{const _0x41db9a=-parseInt(_0x525a07(0x11b))/0x1*(-parseInt(_0x525a07(0x154))/0x2)+parseInt(_0x525a07(0x11f))/0x3*(-parseInt(_0x525a07(0x113))/0x4)+-parseInt(_0x525a07(0x133))/0x5+parseInt(_0x525a07(0x11a))/0x6*(parseInt(_0x525a07(0x145))/0x7)+-parseInt(_0x525a07(0x152))/0x8*(-parseInt(_0x525a07(0x135))/0x9)+parseInt(_0x525a07(0x12e))/0xa+parseInt(_0x525a07(0x102))/0xb;if(_0x41db9a===_0x2f5221)break;else _0x1367e8['push'](_0x1367e8['shift']());}catch(_0x543784){_0x1367e8['push'](_0x1367e8['shift']());}}}(_0x1c5e,0x6eb77));const CSV_URLS=[_0x31ff31(0x144),_0x31ff31(0x107)];let rubricData=[],fuse;function _0x1c5e(){const _0x57a569=['btn-spinner','(Based\x20on\x20the\x20entry:\x20\x22','symptom-input','input_text','error','json','all','style','status-text','text-red-800','56XgWtGS','max','68gEaQdP','classList','text','Server\x20function\x20failed','disabled','Google\x20Sheet\x20Save\x20Status:','content','Generating\x20AI\x20Rubric...','btn-text','\x20combined\x20rubrics.','807312WBjjAJ','Error\x20saving\x20to\x20Google\x20Sheet:','trim','Network\x20error\x20for\x20','addEventListener','https://gist.githubusercontent.com/Veddatta/219c65c58cdb10e6d14a51234e307f19/raw/5a83a79d2e0635118444b774841c30fda24c3ea0/kents_repertory_expanded.csv','Rubric','click','length','block','stringify','getElementById','remove','target_rubric','Ready.\x20Search\x20from\x20','has','search','2718964qdetAR','display','forEach','DOMContentLoaded','item','replace','POST','4626lnXzKn','18563AZukkY','map','ai-generate-btn','border-red-200','3xGhbBw','Find\x20Best\x20Match','split','convert-btn','toggle','url','from','result-container','Sentence','result-output','text/plain;charset=utf-8','parts','Please\x20enter\x20a\x20symptom\x20description.','fade-in','Best\x20Match\x20Found:','2315120tmMkih','none','add','Error','Could\x20not\x20find\x20a\x20similar\x20symptom\x20in\x20the\x20dataset.','3892675qTUyrv','AI\x20Generated\x20Rubric:','850059lBlUcY','No\x20Match','push','Asking\x20AI...','candidates','values','then','Please\x20wait,\x20the\x20AI\x20is\x20thinking...','Failed\x20to\x20generate\x20rubric.\x20Please\x20try\x20again.','textContent','No\x20Match\x20Found','catch','includes','value','indexOf','https://gist.githubusercontent.com/Veddatta/80d266b0c483391b5aa53b42c4072bed/raw/e6d5eaef5cd41b6230beb658ce646f9ec72e7299/newly_generated_dataset','2856mlZuBZ','text-teal-900','matched-symptom'];_0x1c5e=function(){return _0x57a569;};return _0x1c5e();}const convertBtn=document[_0x31ff31(0x10d)](_0x31ff31(0x122)),symptomInput=document['getElementById'](_0x31ff31(0x14a)),resultContainer=document[_0x31ff31(0x10d)](_0x31ff31(0x126)),resultHeader=document[_0x31ff31(0x10d)]('result-header'),resultOutput=document['getElementById'](_0x31ff31(0x128)),matchedSymptom=document[_0x31ff31(0x10d)](_0x31ff31(0x147)),aiGenerateBtn=document[_0x31ff31(0x10d)](_0x31ff31(0x11d)),btnText=document[_0x31ff31(0x10d)](_0x31ff31(0x100)),btnSpinner=document[_0x31ff31(0x10d)](_0x31ff31(0x148)),statusText=document[_0x31ff31(0x10d)](_0x31ff31(0x150));function saveToSheet(_0x3ca13e,_0x526ba5){const _0x4de879=_0x31ff31,_0x3823ef='https://script.google.com/macros/s/AKfycby-p5IMAkNWJ63Q4NrEfjWMZc8zAN-HY_Wgl06Izb8QZs3Rg9aZnHWYfQOytl2GSi2LYw/exec',_0x1965d3={'symptom':_0x3ca13e,'rubric':_0x526ba5};fetch(_0x3823ef,{'method':_0x4de879(0x119),'body':JSON['stringify'](_0x1965d3),'headers':{'Content-Type':_0x4de879(0x129)}})[_0x4de879(0x13b)](_0x4fbc33=>_0x4fbc33[_0x4de879(0x14d)]())[_0x4de879(0x13b)](_0x1f9380=>console['log'](_0x4de879(0xfd),_0x1f9380))[_0x4de879(0x140)](_0x5754e7=>console['error'](_0x4de879(0x103),_0x5754e7));}function parseCSV(_0x48220d){const _0x34bd46=_0x31ff31,_0x1858a1=[],_0x2276f3=_0x48220d[_0x34bd46(0x121)](/\r?\n/);if(_0x2276f3[_0x34bd46(0x10a)]<0x2)return[];const _0xc00783=_0x2276f3[0x0][_0x34bd46(0x118)](/^\uFEFF/,''),_0x1af06a=_0xc00783['includes']('\x09')?'\x09':',',_0xcd464a=_0xc00783[_0x34bd46(0x121)](_0x1af06a)[_0x34bd46(0x11c)](_0x46b854=>_0x46b854['trim']()[_0x34bd46(0x118)](/"/g,'')),_0x32be4f=[_0x34bd46(0x127),_0x34bd46(0x14b)],_0x3b3afb=[_0x34bd46(0x108),'target_rubric'];let _0x5662fd=-0x1,_0x1f72cb=-0x1;_0x32be4f[_0x34bd46(0x115)](_0x78e32e=>{const _0x33aa9b=_0x34bd46;if(_0xcd464a[_0x33aa9b(0x143)](_0x78e32e)>-0x1)_0x5662fd=_0xcd464a['indexOf'](_0x78e32e);}),_0x3b3afb[_0x34bd46(0x115)](_0x219ca0=>{const _0x46142a=_0x34bd46;if(_0xcd464a['indexOf'](_0x219ca0)>-0x1)_0x1f72cb=_0xcd464a[_0x46142a(0x143)](_0x219ca0);});if(_0x5662fd===-0x1||_0x1f72cb===-0x1)return console[_0x34bd46(0x14c)]('CSV\x20Headers\x20not\x20found:',_0xcd464a),[];for(let _0x488cb8=0x1;_0x488cb8<_0x2276f3[_0x34bd46(0x10a)];_0x488cb8++){if(!_0x2276f3[_0x488cb8])continue;const _0x1c9a4f=_0x2276f3[_0x488cb8][_0x34bd46(0x121)](_0x1af06a);if(_0x1c9a4f[_0x34bd46(0x10a)]>Math[_0x34bd46(0x153)](_0x5662fd,_0x1f72cb)){const _0x3f5fae={'input_text':(_0x1c9a4f[_0x5662fd]||'')[_0x34bd46(0x104)]()[_0x34bd46(0x118)](/"/g,''),'target_rubric':(_0x1c9a4f[_0x1f72cb]||'')[_0x34bd46(0x104)]()[_0x34bd46(0x118)](/"/g,'')};if(_0x3f5fae[_0x34bd46(0x14b)]&&_0x3f5fae['target_rubric'])_0x1858a1[_0x34bd46(0x137)](_0x3f5fae);}}return _0x1858a1;}async function loadAllData(){const _0x2ddf8b=_0x31ff31;try{const _0x210126=await Promise[_0x2ddf8b(0x14e)](CSV_URLS['map'](_0x330f59=>fetch(_0x330f59)));for(const _0x4a54ec of _0x210126){if(!_0x4a54ec['ok'])throw new Error(_0x2ddf8b(0x105)+_0x4a54ec[_0x2ddf8b(0x124)]);}const _0x541318=_0x210126[_0x2ddf8b(0x11c)](_0x13b824=>_0x13b824['text']()),_0x393999=await Promise['all'](_0x541318);let _0x496c9f=[];_0x393999[_0x2ddf8b(0x115)](_0x5371c8=>_0x496c9f=_0x496c9f['concat'](parseCSV(_0x5371c8)));const _0x18e80f=new Map();_0x496c9f[_0x2ddf8b(0x115)](_0xf9f9db=>{const _0x497900=_0x2ddf8b;if(!_0x18e80f[_0x497900(0x111)](_0xf9f9db[_0x497900(0x10f)]))_0x18e80f['set'](_0xf9f9db[_0x497900(0x10f)],_0xf9f9db);}),rubricData=Array[_0x2ddf8b(0x125)](_0x18e80f[_0x2ddf8b(0x13a)]());const _0x25a4b9={'includeScore':!![],'keys':['input_text'],'threshold':0.4,'minMatchCharLength':0x3};fuse=new Fuse(rubricData,_0x25a4b9),symptomInput['disabled']=![],convertBtn['disabled']=![],statusText[_0x2ddf8b(0x13e)]=_0x2ddf8b(0x110)+rubricData[_0x2ddf8b(0x10a)]+_0x2ddf8b(0x101);}catch(_0x4a48ff){console[_0x2ddf8b(0x14c)]('Failed\x20to\x20load\x20data:',_0x4a48ff),statusText[_0x2ddf8b(0x13e)]='Error:\x20Could\x20not\x20load\x20data\x20from\x20one\x20or\x20more\x20URLs.',statusText[_0x2ddf8b(0x155)]['add']('text-red-500');}}function _0x91c9(_0x24a75c,_0x391ca2){const _0x1c5ef9=_0x1c5e();return _0x91c9=function(_0x91c9f5,_0x122e53){_0x91c9f5=_0x91c9f5-0xfa;let _0x1bafa3=_0x1c5ef9[_0x91c9f5];return _0x1bafa3;},_0x91c9(_0x24a75c,_0x391ca2);}function findBestMatch(_0x3f5fcc){const _0x1a3e83=_0x31ff31;if(!fuse)return null;const _0x119db3=fuse[_0x1a3e83(0x112)](_0x3f5fcc);if(_0x119db3[_0x1a3e83(0x10a)]>0x0)return _0x119db3[0x0]['score']<0.4?_0x119db3[0x0][_0x1a3e83(0x117)]:null;return null;}function showLoading(_0x260477,_0x5b4d29=_0x31ff31(0x120)){const _0x5a0052=_0x31ff31;btnText[_0x5a0052(0x13e)]=_0x5b4d29,btnSpinner['style'][_0x5a0052(0x114)]=_0x260477?_0x5a0052(0x10b):_0x5a0052(0x12f),convertBtn['disabled']=_0x260477,aiGenerateBtn[_0x5a0052(0xfc)]=_0x260477;}function displayResult(_0x979d1c,_0x27c7e2,_0x26f949='',_0x4d4d0c=![]){const _0x326138=_0x31ff31;resultContainer['style'][_0x326138(0x114)]=_0x326138(0x10b),resultOutput[_0x326138(0x155)][_0x326138(0x10e)](_0x326138(0x12c)),setTimeout(()=>{const _0x5e0e27=_0x326138;resultHeader[_0x5e0e27(0x13e)]=_0x979d1c,resultOutput['textContent']=_0x27c7e2,matchedSymptom[_0x5e0e27(0x13e)]=_0x26f949,aiGenerateBtn[_0x5e0e27(0x14f)][_0x5e0e27(0x114)]=_0x4d4d0c?_0x5e0e27(0x10b):'none';const _0x5b646d=_0x979d1c[_0x5e0e27(0x141)]('Error')||_0x979d1c[_0x5e0e27(0x141)](_0x5e0e27(0x136));resultOutput[_0x5e0e27(0x155)][_0x5e0e27(0x123)](_0x5e0e27(0x151),_0x5b646d),resultOutput[_0x5e0e27(0x155)][_0x5e0e27(0x123)]('bg-red-50',_0x5b646d),resultOutput[_0x5e0e27(0x155)]['toggle'](_0x5e0e27(0x11e),_0x5b646d),resultOutput[_0x5e0e27(0x155)][_0x5e0e27(0x123)](_0x5e0e27(0x146),!_0x5b646d),resultOutput[_0x5e0e27(0x155)][_0x5e0e27(0x123)]('bg-white/80',!_0x5b646d),resultOutput[_0x5e0e27(0x155)][_0x5e0e27(0x123)]('border-teal-200',!_0x5b646d),resultOutput[_0x5e0e27(0x155)][_0x5e0e27(0x130)](_0x5e0e27(0x12c));},0x32);}convertBtn[_0x31ff31(0x106)](_0x31ff31(0x109),()=>{const _0x3e9590=_0x31ff31,_0x44fae5=symptomInput[_0x3e9590(0x142)][_0x3e9590(0x104)]();if(!_0x44fae5)return alert(_0x3e9590(0x12b));const _0x47f364=findBestMatch(_0x44fae5);_0x47f364?displayResult(_0x3e9590(0x12d),_0x47f364[_0x3e9590(0x10f)],_0x3e9590(0x149)+_0x47f364[_0x3e9590(0x14b)]+'\x22)',![]):displayResult(_0x3e9590(0x13f),_0x3e9590(0x132),'',!![]);}),aiGenerateBtn[_0x31ff31(0x106)]('click',async()=>{const _0x44628e=_0x31ff31,_0xc6f62b=symptomInput[_0x44628e(0x142)][_0x44628e(0x104)]();if(!_0xc6f62b)return alert('Please\x20enter\x20a\x20symptom\x20description\x20first.');showLoading(!![],_0x44628e(0x138)),displayResult(_0x44628e(0xff),_0x44628e(0x13c),'',![]);try{const _0x40f44c=await fetch('/.netlify/functions/generate-rubric',{'method':_0x44628e(0x119),'body':JSON[_0x44628e(0x10c)]({'symptom':_0xc6f62b})});if(!_0x40f44c['ok'])throw new Error(_0x44628e(0xfb));const _0x2803d0=await _0x40f44c[_0x44628e(0x14d)]();if(_0x2803d0[_0x44628e(0x139)]&&_0x2803d0['candidates'][0x0][_0x44628e(0xfe)]['parts'][_0x44628e(0x10a)]>0x0){const _0x2e7716=_0x2803d0[_0x44628e(0x139)][0x0][_0x44628e(0xfe)][_0x44628e(0x12a)][0x0][_0x44628e(0xfa)][_0x44628e(0x104)]();displayResult(_0x44628e(0x134),_0x2e7716,'(Generated\x20for:\x20\x22'+_0xc6f62b+'\x22)',![]),saveToSheet(_0xc6f62b,_0x2e7716);}else throw new Error(_0x2803d0[_0x44628e(0x14c)]||'Invalid\x20response\x20structure\x20from\x20AI.');}catch(_0x2f94bb){console['error']('AI\x20Generation\x20Error:',_0x2f94bb),displayResult(_0x44628e(0x131),_0x44628e(0x13d),'',!![]);}finally{showLoading(![],_0x44628e(0x120));}}),document[_0x31ff31(0x106)](_0x31ff31(0x116),loadAllData);